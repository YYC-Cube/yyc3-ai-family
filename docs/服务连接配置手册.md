# YYCÂ³ AI Family - æœåŠ¡è¿æ¥é…ç½®æ‰‹å†Œ

> ***YanYuCloudCube***
> è¨€å¯è±¡é™ | è¯­æ¢æœªæ¥
> ***Words Initiate Quadrants, Language Serves as Core for the Future***
> ä¸‡è±¡å½’å…ƒäºäº‘æ¢ | æ·±æ ˆæ™ºå¯æ–°çºªå…ƒ
> ***All things converge in the cloud pivot; Deep stacks ignite a new era of intelligence***

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0.0
**æ›´æ–°æ—¥æœŸ**: 2026-02-22
**é€‚ç”¨èŒƒå›´**: YYCÂ³ AI Family å…¨æ ˆæœåŠ¡
**æ–‡æ¡£çŠ¶æ€**: âœ… å·²éªŒè¯

---

## ğŸ“‹ ç›®å½•

1. [ç½‘ç»œæ‹“æ‰‘æ¦‚è§ˆ](#1-ç½‘ç»œæ‹“æ‰‘æ¦‚è§ˆ)
2. [æ•°æ®åº“æœåŠ¡](#2-æ•°æ®åº“æœåŠ¡)
3. [AIæ¨¡å‹æœåŠ¡](#3-aiæ¨¡å‹æœåŠ¡)
4. [Webåº”ç”¨æœåŠ¡](#4-webåº”ç”¨æœåŠ¡)
5. [NASå­˜å‚¨æœåŠ¡](#5-naså­˜å‚¨æœåŠ¡)
6. [ç¯å¢ƒå˜é‡é…ç½®](#6-ç¯å¢ƒå˜é‡é…ç½®)
7. [è¿æ¥æµ‹è¯•è„šæœ¬](#7-è¿æ¥æµ‹è¯•è„šæœ¬)
8. [æ•…éšœæ’æŸ¥æŒ‡å—](#8-æ•…éšœæ’æŸ¥æŒ‡å—)

---

## 1. ç½‘ç»œæ‹“æ‰‘æ¦‚è§ˆ

### 1.1 é›†ç¾¤æ¶æ„

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚         YYCÂ³ Cluster Network            â”‚
                    â”‚           192.168.3.x/24                â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                                â”‚                                â”‚
   â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”                   â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
   â”‚ M4 Max  â”‚                    â”‚ YanYuCloud  â”‚                   â”‚ iMac M4 â”‚
   â”‚ (Main)  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚    NAS      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ (Aux)   â”‚
   â”‚ ç¼–æ’å™¨   â”‚                    â”‚  æ•°æ®ä¸­å¿ƒ    â”‚                   â”‚ å¯è§†åŒ–   â”‚
   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
        â”‚                                â”‚                                â”‚
        â”‚                                â”‚                                â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
        â”‚  â”‚                     æœåŠ¡ç«¯å£åˆ†å¸ƒ                           â”‚  â”‚
        â”‚  â”‚  NAS: 5434(PG), 6379(Redis), 2375(Docker), 9090(WS)      â”‚  â”‚
        â”‚  â”‚  M4: 3200(Frontend), 3210(API), 11434(Ollama)            â”‚  â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
        â”‚                                                                 â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 èŠ‚ç‚¹ä¿¡æ¯

| èŠ‚ç‚¹ | ä¸»æœºå | IPåœ°å€ | è§’è‰² | æ ¸å¿ƒé…ç½® |
|------|--------|--------|------|----------|
| **M4-Max** | localhost | 127.0.0.1 / 192.168.3.x | ç¼–æ’å™¨ (ä¸»åŠ›) | M4 Max, 128GB, 4TB |
| **YanYuCloud** | NAS | 192.168.3.45 | æ•°æ®ä¸­å¿ƒ | Intel Quad, 32GB, 32TB+4TB |
| **iMac-M4** | yyc3-77 | 192.168.3.77 | è¾…åŠ©æ¨ç† | M4, 32GB, 926GB |
| **MateBook** | Edge | 192.168.3.x | è¾¹ç¼˜/æµ‹è¯• | Intel 12th, 32GB |

### 1.3 ç½‘ç»œç«¯å£è§„èŒƒ

| ç«¯å£èŒƒå›´ | ç”¨é€” | è¯´æ˜ |
|----------|------|------|
| 3000-3199 | â›” é™ç”¨ | é¿å…ä½¿ç”¨ |
| 3200-3500 | âœ… é»˜è®¤ | AI Family æœåŠ¡ |
| 5000-6000 | âœ… æ•°æ®åº“ | PostgreSQL, Redis |
| 10000+ | âœ… æ‰©å±• | Ollama, Docker API |

---

## 2. æ•°æ®åº“æœåŠ¡

### 2.1 PostgreSQL æœåŠ¡

#### ä¸»æ•°æ®åº“ (M4 Max æœ¬åœ°)

| é…ç½®é¡¹ | å€¼ |
|--------|-----|
| **æœåŠ¡åç§°** | yyc3_aify |
| **ä¸»æœº** | localhost |
| **ç«¯å£** | 5433 |
| **æ•°æ®åº“** | yyc3_aify |
| **ç”¨æˆ·** | yyc3 |
| **å¯†ç ** | (ç¯å¢ƒå˜é‡) |
| **å­—ç¬¦é›†** | UTF8 |
| **æ—¶åŒº** | Asia/Shanghai |

```bash
# è¿æ¥å­—ç¬¦ä¸²
postgresql://yyc3:PASSWORD@localhost:5433/yyc3_aify

# psql è¿æ¥
psql -h localhost -p 5433 -U yyc3 -d yyc3_aify
```

#### å‘é‡æ•°æ®åº“ (NAS Docker)

| é…ç½®é¡¹ | å€¼ |
|--------|-----|
| **æœåŠ¡åç§°** | yyc3-pgvector |
| **ä¸»æœº** | 192.168.3.45 |
| **ç«¯å£** | 5434 |
| **æ•°æ®åº“** | yyc3_vectors |
| **ç”¨æˆ·** | yyc3 |
| **å¯†ç ** | yyc3_vector_2026 |
| **æ‰©å±•** | pgvector 0.8.1 |
| **å®¹å™¨** | pgvector/pgvector:pg14 |

```bash
# è¿æ¥å­—ç¬¦ä¸²
postgresql://yyc3:yyc3_vector_2026@192.168.3.45:5434/yyc3_vectors

# psql è¿æ¥
PGPASSWORD=yyc3_vector_2026 psql -h 192.168.3.45 -p 5434 -U yyc3 -d yyc3_vectors
```

#### NAS ç³»ç»Ÿæ•°æ®åº“ (å‹¿åŠ¨)

| æ•°æ®åº“ | ç«¯å£ | ç”¨é€” | çŠ¶æ€ |
|--------|------|------|------|
| PostgreSQL 13 | 5032 | ç³»ç»ŸæœåŠ¡ | â›” å‹¿åŠ¨ |
| PostgreSQL 14 (okm) | 5432 | ä¸šåŠ¡æ•°æ®åº“ | âš ï¸ è°¨æ… |
| MySQL | 3306 | ä¸šåŠ¡æ•°æ®åº“ | âš ï¸ è°¨æ… |

### 2.2 Redis ç¼“å­˜æœåŠ¡

| é…ç½®é¡¹ | å€¼ |
|--------|-----|
| **ä¸»æœº** | localhost |
| **ç«¯å£** | 6379 |
| **æŒä¹…åŒ–** | RDB + AOF |
| **æœ€å¤§å†…å­˜** | 4GB |
| **æ·˜æ±°ç­–ç•¥** | allkeys-lru |

```bash
# è¿æ¥ Redis
redis-cli -h localhost -p 6379

# æµ‹è¯•è¿æ¥
redis-cli ping
# è¾“å‡º: PONG
```

### 2.3 æ•°æ®åº“è¿æ¥æ± é…ç½®

```typescript
// PostgreSQL è¿æ¥æ± 
import { Pool } from 'pg';

const mainDbPool = new Pool({
  host: 'localhost',
  port: 5433,
  database: 'yyc3_aify',
  user: 'yyc3',
  password: process.env.PG_PASSWORD,
  max: 20,
  idleTimeoutMillis: 30000,
  connectionTimeoutMillis: 2000,
});

const vectorDbPool = new Pool({
  host: '192.168.3.45',
  port: 5434,
  database: 'yyc3_vectors',
  user: 'yyc3',
  password: 'yyc3_vector_2026',
  max: 10,
  idleTimeoutMillis: 30000,
  connectionTimeoutMillis: 2000,
});
```

---

## 3. AIæ¨¡å‹æœåŠ¡

### 3.1 Ollama æœ¬åœ°æ¨ç†

#### M4 Max Ollama

| é…ç½®é¡¹ | å€¼ |
|--------|-----|
| **ä¸»æœº** | localhost |
| **ç«¯å£** | 11434 |
| **API åœ°å€** | <http://localhost:11434> |
| **æ¨¡å‹ç›®å½•** | ~/.ollama/models |

**å·²éƒ¨ç½²æ¨¡å‹**:

| æ¨¡å‹ | å‚æ•°é‡ | é‡åŒ– | å¤§å° | ç”¨é€” |
|------|--------|------|------|------|
| codegeex4:latest | 9.4B | Q4_0 | 5.4GB | ä»£ç ç”Ÿæˆ |
| qwen2.5:7b | 7.6B | Q4_K_M | 4.7GB | é€šç”¨å¯¹è¯ |
| qwen2.5-coder:1.5b | 1.5B | Q4_K_M | 0.9GB | è½»é‡ä»£ç  |
| nomic-embed-text | 137M | F16 | 0.3GB | æ–‡æœ¬åµŒå…¥ |

```bash
# API ç«¯ç‚¹
curl http://localhost:11434/api/tags

# ç”Ÿæˆæ–‡æœ¬
curl http://localhost:11434/api/generate -d '{
  "model": "qwen2.5:7b",
  "prompt": "ä½ å¥½"
}'

# èŠå¤©è¡¥å…¨
curl http://localhost:11434/api/chat -d '{
  "model": "qwen2.5:7b",
  "messages": [{"role": "user", "content": "ä½ å¥½"}]
}'

# ç”ŸæˆåµŒå…¥
curl http://localhost:11434/api/embeddings -d '{
  "model": "nomic-embed-text",
  "prompt": "æµ‹è¯•æ–‡æœ¬"
}'
```

#### NAS Ollama (Docker)

| é…ç½®é¡¹ | å€¼ |
|--------|-----|
| **ä¸»æœº** | 192.168.3.45 |
| **ç«¯å£** | 11434 |
| **API åœ°å€** | <http://192.168.3.45:11434> |
| **å®¹å™¨** | ollama/ollama |

```bash
# æ£€æŸ¥ NAS Ollama çŠ¶æ€
curl http://192.168.3.45:11434/api/tags
```

#### iMac M4 Ollama (yyc3-77)

| é…ç½®é¡¹ | å€¼ |
|--------|-----|
| **ä¸»æœº** | 192.168.3.77 |
| **ç«¯å£** | 11434 |
| **API åœ°å€** | <http://192.168.3.77:11434> |
| **Ollama ç‰ˆæœ¬** | 0.16.3 |

**å·²éƒ¨ç½²æ¨¡å‹**:

| æ¨¡å‹ | å‚æ•°é‡ | å¤§å° | ç”¨é€” | æ™ºèƒ½ä½“ |
|------|--------|------|------|--------|
| glm4:9b | 9B | 5.5 GB | æ ¸å¿ƒåè°ƒ | Pivot |
| phi3:mini | 3.8B | 2.2 GB | å®‰å…¨å“¨å…µ | Sentinel |
| codegeex4:latest | 9.4B | 5.5 GB | ä»£ç è¯„ä¼° | Bole |
| phi3:14b | 14B | 7.9 GB | å¤‡ç”¨ | Sentinel |
| llama3:latest | 8B | 4.7 GB | é€šç”¨ | - |
| mixtral:latest | 47B | 26 GB | å¤§æ¨¡å‹ | - |

```bash
# SSH è¿æ¥
ssh yyc3-77

# æ£€æŸ¥ iMac Ollama çŠ¶æ€
curl http://192.168.3.77:11434/api/tags

# æµ‹è¯•æ¨¡å‹
curl http://192.168.3.77:11434/api/generate -d '{
  "model": "phi3:mini",
  "prompt": "æµ‹è¯•"
}'
```

### 3.2 äº‘ç«¯ API æœåŠ¡

#### DeepSeek API

| é…ç½®é¡¹ | å€¼ |
|--------|-----|
| **API ç«¯ç‚¹** | <https://api.deepseek.com> |
| **æ¨¡å‹** | deepseek-chat, deepseek-reasoner |
| **è®¤è¯** | Bearer Token |
| **ç¯å¢ƒå˜é‡** | DEEPSEEK_API_KEY |

```typescript
// DeepSeek API è°ƒç”¨
const response = await fetch('https://api.deepseek.com/chat/completions', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'Authorization': `Bearer ${process.env.DEEPSEEK_API_KEY}`,
  },
  body: JSON.stringify({
    model: 'deepseek-chat',
    messages: [{ role: 'user', content: 'ä½ å¥½' }],
  }),
});
```

#### OpenAI API

| é…ç½®é¡¹ | å€¼ |
|--------|-----|
| **API ç«¯ç‚¹** | <https://api.openai.com/v1> |
| **æ¨¡å‹** | gpt-4.1, gpt-4o, gpt-4o-mini |
| **è®¤è¯** | Bearer Token |
| **ç¯å¢ƒå˜é‡** | OPENAI_API_KEY |

#### Anthropic API

| é…ç½®é¡¹ | å€¼ |
|--------|-----|
| **API ç«¯ç‚¹** | <https://api.anthropic.com/v1> |
| **æ¨¡å‹** | claude-4, claude-3.5-sonnet |
| **è®¤è¯** | x-api-key Header |
| **ç¯å¢ƒå˜é‡** | ANTHROPIC_API_KEY |

#### æ™ºè°± API

| é…ç½®é¡¹ | å€¼ |
|--------|-----|
| **API ç«¯ç‚¹** | <https://open.bigmodel.cn/api/paas/v4> |
| **æ¨¡å‹** | glm-4, glm-4-flash |
| **è®¤è¯** | Bearer Token |
| **ç¯å¢ƒå˜é‡** | ZHIPU_API_KEY |

### 3.3 LLM Bridge é…ç½®

```typescript
// LLM Bridge - æ™ºèƒ½è·¯ç”±
const llmBridge = {
  // æœ¬åœ°æ¨¡å‹
  local: {
    ollama: {
      host: 'http://localhost:11434',
      models: ['qwen2.5:7b', 'codegeex4:latest', 'nomic-embed-text'],
    },
    nasOllama: {
      host: 'http://192.168.3.45:11434',
      models: [],
    },
  },
  
  // äº‘ç«¯ API
  cloud: {
    deepseek: {
      host: 'https://api.deepseek.com',
      models: ['deepseek-chat', 'deepseek-reasoner'],
      apiKey: process.env.DEEPSEEK_API_KEY,
    },
    openai: {
      host: 'https://api.openai.com/v1',
      models: ['gpt-4.1', 'gpt-4o'],
      apiKey: process.env.OPENAI_API_KEY,
    },
    anthropic: {
      host: 'https://api.anthropic.com/v1',
      models: ['claude-4', 'claude-3.5-sonnet'],
      apiKey: process.env.ANTHROPIC_API_KEY,
    },
    zhipu: {
      host: 'https://open.bigmodel.cn/api/paas/v4',
      models: ['glm-4', 'glm-4-flash'],
      apiKey: process.env.ZHIPU_API_KEY,
    },
  },
  
  // è·¯ç”±è§„åˆ™
  routing: {
    code: { primary: 'codegeex4', fallback: 'deepseek-chat' },
    reasoning: { primary: 'deepseek-reasoner', fallback: 'claude-4' },
    chat: { primary: 'qwen2.5:7b', fallback: 'deepseek-chat' },
    embedding: { primary: 'nomic-embed-text', fallback: null },
  },
};
```

---

## 4. Webåº”ç”¨æœåŠ¡

### 4.1 å‰ç«¯åº”ç”¨

| é…ç½®é¡¹ | å€¼ |
|--------|-----|
| **æœåŠ¡åç§°** | AI Family Frontend |
| **ä¸»æœº** | localhost |
| **ç«¯å£** | 3200 |
| **è®¿é—®åœ°å€** | <http://localhost:3200> |
| **æ¡†æ¶** | React 18 + Vite |

```bash
# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
cd /Users/yanyu/YYC3-Mac-Max/Family-Ï€Â³/AI-Family
pnpm dev

# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
pnpm build

# é¢„è§ˆç”Ÿäº§ç‰ˆæœ¬
pnpm preview
```

### 4.2 åç«¯ API æœåŠ¡

| é…ç½®é¡¹ | å€¼ |
|--------|-----|
| **æœåŠ¡åç§°** | D-Music API |
| **ä¸»æœº** | localhost |
| **ç«¯å£** | 3210 |
| **API åœ°å€** | <http://localhost:3210> |
| **æ¡†æ¶** | Express.js |

**API ç«¯ç‚¹**:

| ç«¯ç‚¹ | æ–¹æ³• | è¯´æ˜ |
|------|------|------|
| /api/chat | POST | AI å¯¹è¯æ¥å£ |
| /api/lyrics | POST | æ­Œè¯ç”Ÿæˆæ¥å£ |
| /api/stt | POST | è¯­éŸ³è½¬æ–‡å­—æ¥å£ |
| /api/star-power | GET | æ˜ŸåŠ›ç³»ç»Ÿæ¥å£ |
| /health | GET | å¥åº·æ£€æŸ¥ |

```bash
# å¥åº·æ£€æŸ¥
curl http://localhost:3210/health

# AI å¯¹è¯
curl -X POST http://localhost:3210/api/chat \
  -H "Content-Type: application/json" \
  -d '{"message": "ä½ å¥½", "model": "qwen2.5:7b"}'
```

### 4.3 WebSocket æœåŠ¡

| é…ç½®é¡¹ | å€¼ |
|--------|-----|
| **æœåŠ¡åç§°** | WebSocket Server |
| **ä¸»æœº** | localhost |
| **ç«¯å£** | 3001 |
| **WebSocket åœ°å€** | ws://localhost:3001 |

```typescript
// WebSocket å®¢æˆ·ç«¯è¿æ¥
const ws = new WebSocket('ws://localhost:3001');

ws.onopen = () => {
  console.log('WebSocket connected');
  ws.send(JSON.stringify({ type: 'subscribe', channel: 'updates' }));
};

ws.onmessage = (event) => {
  const data = JSON.parse(event.data);
  console.log('Received:', data);
};
```

---

## 5. NASå­˜å‚¨æœåŠ¡

### 5.1 æ–‡ä»¶å…±äº«

| æœåŠ¡ | åè®® | ç«¯å£ | è®¿é—®åœ°å€ |
|------|------|------|----------|
| SMB | TCP | 445 | smb://192.168.3.45 |
| NFS | TCP | 2049 | nfs://192.168.3.45 |
| WebDAV | HTTP | 5005 | <http://192.168.3.45:5005> |

```bash
# macOS æŒ‚è½½ SMB
open smb://YYC@192.168.3.45

# å‘½ä»¤è¡ŒæŒ‚è½½
mount_smbfs //YYC@192.168.3.45/share /mnt/nas
```

### 5.2 NAS ç®¡ç†ç•Œé¢

| é…ç½®é¡¹ | å€¼ |
|--------|-----|
| **Web ç•Œé¢** | <http://192.168.3.45:9898> |
| **SSH è®¿é—®** | ssh -p 9557 YYC@192.168.3.45 |
| **Docker API** | <http://192.168.3.45:2375> |

### 5.3 Docker æœåŠ¡ (NAS)

| é…ç½®é¡¹ | å€¼ |
|--------|-----|
| **Docker è·¯å¾„** | /Volume2/@apps/DockerEngine/dockerd/bin/docker |
| **API ç«¯å£** | 2375 |
| **Registry é•œåƒ** | docker.1ms.run |

**è¿è¡Œä¸­çš„å®¹å™¨**:

| å®¹å™¨åç§° | é•œåƒ | ç«¯å£ | çŠ¶æ€ |
|----------|------|------|------|
| yyc3-pgvector | pgvector/pgvector:pg14 | 5434:5432 | âœ… è¿è¡Œä¸­ |
| docker-api-proxy | alpine:3.19 | 2375:2375 | âœ… è¿è¡Œä¸­ |
| yyc3-heartbeat | node:18-alpine | 9090:9090 | âœ… è¿è¡Œä¸­ |
| sqlite-http | alpine:3.19 | 8080:8080 | âœ… è¿è¡Œä¸­ |
| ollama | ollama/ollama | 11434:11434 | âœ… è¿è¡Œä¸­ |

### 5.4 NAS æœåŠ¡éƒ¨ç½²è„šæœ¬

```bash
#!/bin/bash
# æ–‡ä»¶: /Users/yanyu/YYC3-Mac-Max/Family-Ï€Â³/scripts/nas-service-manager.sh

NAS_HOST="192.168.3.45"
NAS_USER="YYC"
NAS_SSH_PORT="9557"
DOCKER_CMD="/Volume2/@apps/DockerEngine/dockerd/bin/docker"

# SSH è¿æ¥å‡½æ•°
ssh_nas() {
  ssh -p $NAS_SSH_PORT $NAS_USER@$NAS_HOST "$1"
}

# æŸ¥çœ‹æ‰€æœ‰æœåŠ¡çŠ¶æ€
check_all_services() {
  echo "=== NAS æœåŠ¡çŠ¶æ€ ==="
  ssh_nas "$DOCKER_CMD ps --format 'table {{.Names}}\t{{.Status}}\t{{.Ports}}'"
}

# é‡å¯æŒ‡å®šæœåŠ¡
restart_service() {
  local service=$1
  echo "é‡å¯æœåŠ¡: $service"
  ssh_nas "$DOCKER_CMD restart $service"
}

# æŸ¥çœ‹æœåŠ¡æ—¥å¿—
view_logs() {
  local service=$1
  ssh_nas "$DOCKER_CMD logs --tail 50 $service"
}

# ä¸»èœå•
case "$1" in
  status) check_all_services ;;
  restart) restart_service "$2" ;;
  logs) view_logs "$2" ;;
  *) echo "Usage: $0 {status|restart|logs} [service_name]" ;;
esac
```

---

## 6. ç¯å¢ƒå˜é‡é…ç½®

### 6.1 å¼€å‘ç¯å¢ƒ (.env.development)

```bash
# åº”ç”¨é…ç½®
VITE_APP_TITLE=YYCÂ³ AI Family
VITE_APP_ENV=development

# API é…ç½®
VITE_API_BASE_URL=http://localhost:3210
VITE_WS_URL=ws://localhost:3001

# Ollama é…ç½®
VITE_OLLAMA_URL=http://localhost:11434
VITE_NAS_OLLAMA_URL=http://192.168.3.45:11434
VITE_IMAC_OLLAMA_URL=http://192.168.3.77:11434

# NAS é…ç½®
VITE_NAS_URL=http://192.168.3.45:9898
VITE_NAS_SSH_PORT=9557
VITE_NAS_DOCKER_API=http://192.168.3.45:2375

# PostgreSQL é…ç½®
VITE_PG_HOST=localhost
VITE_PG_PORT=5433
VITE_PG_DATABASE=yyc3_aify
VITE_PG_USER=yyc3
VITE_PG_PASSWORD=your_password_here

# å‘é‡æ•°æ®åº“é…ç½®
VITE_VECTOR_DB_HOST=192.168.3.45
VITE_VECTOR_DB_PORT=5434
VITE_VECTOR_DB_NAME=yyc3_vectors
VITE_VECTOR_DB_USER=yyc3
VITE_VECTOR_DB_PASSWORD=yyc3_vector_2026

# Redis é…ç½®
VITE_REDIS_HOST=localhost
VITE_REDIS_PORT=6379
```

### 6.2 ç”Ÿäº§ç¯å¢ƒ (.env.production)

```bash
# åº”ç”¨é…ç½®
VITE_APP_TITLE=YYCÂ³ AI Family
VITE_APP_ENV=production

# API é…ç½®
VITE_API_BASE_URL=https://api.yyc3.local
VITE_WS_URL=wss://ws.yyc3.local

# Ollama é…ç½®
VITE_OLLAMA_URL=http://localhost:11434
VITE_NAS_OLLAMA_URL=http://192.168.3.45:11434

# æ•°æ®åº“é…ç½® (ä½¿ç”¨å†…ç½‘åœ°å€)
VITE_PG_HOST=192.168.3.45
VITE_PG_PORT=5433
VITE_VECTOR_DB_HOST=192.168.3.45
VITE_VECTOR_DB_PORT=5434
```

### 6.3 API Keys é…ç½® (.env.keys)

```bash
# DeepSeek
DEEPSEEK_API_KEY=sk-your-deepseek-key

# OpenAI
OPENAI_API_KEY=sk-your-openai-key

# Anthropic
ANTHROPIC_API_KEY=sk-ant-your-anthropic-key

# æ™ºè°±
ZHIPU_API_KEY=your-zhipu-api-key

# Google
GOOGLE_API_KEY=your-google-api-key

# Groq
GROQ_API_KEY=gsk-your-groq-key
```

---

## 7. è¿æ¥æµ‹è¯•è„šæœ¬

### 7.1 å…¨é‡è¿æ¥æµ‹è¯•

```bash
#!/bin/bash
# æ–‡ä»¶: /Users/yanyu/YYC3-Mac-Max/Family-Ï€Â³/scripts/test-all-connections.sh

echo "========================================"
echo "  YYCÂ³ AI Family è¿æ¥æµ‹è¯•"
echo "  æ—¶é—´: $(date '+%Y-%m-%d %H:%M:%S')"
echo "========================================"
echo ""

# æµ‹è¯•ç»“æœç»Ÿè®¡
PASS=0
FAIL=0

# æµ‹è¯•å‡½æ•°
test_connection() {
  local name=$1
  local command=$2
  
  printf "%-30s" "$name"
  if eval "$command" &>/dev/null; then
    echo "âœ… é€šè¿‡"
    ((PASS++))
  else
    echo "âŒ å¤±è´¥"
    ((FAIL++))
  fi
}

echo "ğŸ“¡ ç½‘ç»œè¿æ¥æµ‹è¯•"
echo "----------------------------------------"
test_connection "NAS SSH" "nc -z 192.168.3.45 9557"
test_connection "NAS Web" "curl -s http://192.168.3.45:9898 > /dev/null"
test_connection "NAS Docker API" "curl -s http://192.168.3.45:2375/version > /dev/null"
echo ""

echo "ğŸ—„ï¸ æ•°æ®åº“è¿æ¥æµ‹è¯•"
echo "----------------------------------------"
test_connection "PostgreSQL (æœ¬åœ°)" "nc -z localhost 5433"
test_connection "PostgreSQL (NAS)" "nc -z 192.168.3.45 5434"
test_connection "Redis" "nc -z localhost 6379"
echo ""

echo "ğŸ¤– AI æ¨¡å‹æœåŠ¡æµ‹è¯•"
echo "----------------------------------------"
test_connection "Ollama (æœ¬åœ°)" "curl -s http://localhost:11434/api/tags > /dev/null"
test_connection "Ollama (NAS)" "curl -s http://192.168.3.45:11434/api/tags > /dev/null"
echo ""

echo "ğŸŒ Web æœåŠ¡æµ‹è¯•"
echo "----------------------------------------"
test_connection "Frontend (3200)" "nc -z localhost 3200"
test_connection "API Server (3210)" "nc -z localhost 3210"
test_connection "WebSocket (3001)" "nc -z localhost 3001"
echo ""

echo "========================================"
echo "  æµ‹è¯•ç»“æœ: âœ… $PASS é€šè¿‡ | âŒ $FAIL å¤±è´¥"
echo "========================================"

# è¿”å›å¤±è´¥æ•°
exit $FAIL
```

### 7.2 æ•°æ®åº“è¿æ¥æµ‹è¯•

```bash
#!/bin/bash
# æ–‡ä»¶: /Users/yanyu/YYC3-Mac-Max/Family-Ï€Â³/scripts/test-db-connections.sh

echo "=== æ•°æ®åº“è¿æ¥æµ‹è¯• ==="
echo ""

# æµ‹è¯•æœ¬åœ° PostgreSQL
echo "ğŸ“¦ æœ¬åœ° PostgreSQL (5433):"
PGPASSWORD=$PG_PASSWORD psql -h localhost -p 5433 -U yyc3 -d yyc3_aify -c "SELECT 'Connected!' as status;" 2>/dev/null && echo "âœ… è¿æ¥æˆåŠŸ" || echo "âŒ è¿æ¥å¤±è´¥"
echo ""

# æµ‹è¯• NAS å‘é‡æ•°æ®åº“
echo "ğŸ“¦ NAS pgvector (5434):"
PGPASSWORD=yyc3_vector_2026 psql -h 192.168.3.45 -p 5434 -U yyc3 -d yyc3_vectors -c "SELECT extname, extversion FROM pg_extension WHERE extname = 'vector';" 2>/dev/null && echo "âœ… è¿æ¥æˆåŠŸ" || echo "âŒ è¿æ¥å¤±è´¥"
echo ""

# æµ‹è¯• Redis
echo "ğŸ“¦ Redis (6379):"
redis-cli ping 2>/dev/null && echo "âœ… è¿æ¥æˆåŠŸ" || echo "âŒ è¿æ¥å¤±è´¥"
echo ""
```

### 7.3 Ollama æ¨¡å‹æµ‹è¯•

```bash
#!/bin/bash
# æ–‡ä»¶: /Users/yanyu/YYC3-Mac-Max/Family-Ï€Â³/scripts/test-ollama-models.sh

echo "=== Ollama æ¨¡å‹æµ‹è¯• ==="
echo ""

echo "ğŸ“¦ æœ¬åœ° Ollama æ¨¡å‹åˆ—è¡¨:"
curl -s http://localhost:11434/api/tags | jq -r '.models[] | "  - \(.name) (\(.details.parameter_size // "N/A"))"'
echo ""

echo "ğŸ“¦ NAS Ollama æ¨¡å‹åˆ—è¡¨:"
curl -s http://192.168.3.45:11434/api/tags | jq -r '.models[] | "  - \(.name) (\(.details.parameter_size // "N/A"))"' 2>/dev/null || echo "  âŒ æ— æ³•è¿æ¥"
echo ""

echo "ğŸ§ª æ¨¡å‹æ¨ç†æµ‹è¯• (qwen2.5:7b):"
curl -s http://localhost:11434/api/generate -d '{
  "model": "qwen2.5:7b",
  "prompt": "è¯´ä¸€ä¸ªå­—",
  "stream": false
}' | jq -r '.response'
echo ""

echo "ğŸ§ª åµŒå…¥å‘é‡æµ‹è¯• (nomic-embed-text):"
curl -s http://localhost:11434/api/embeddings -d '{
  "model": "nomic-embed-text",
  "prompt": "æµ‹è¯•æ–‡æœ¬"
}' | jq '.embedding | length'
echo ""
```

---

## 8. æ•…éšœæ’æŸ¥æŒ‡å—

### 8.1 å¸¸è§é—®é¢˜

#### é—®é¢˜ 1: NAS SSH è¿æ¥å¤±è´¥

```bash
# æ£€æŸ¥ç½‘ç»œè¿é€šæ€§
ping 192.168.3.45

# æ£€æŸ¥ç«¯å£
nc -zv 192.168.3.45 9557

# æ£€æŸ¥ SSH æœåŠ¡
ssh -v -p 9557 YYC@192.168.3.45
```

**è§£å†³æ–¹æ¡ˆ**:

1. ç¡®è®¤ NAS å¼€æœºä¸”ç½‘ç»œæ­£å¸¸
2. ç¡®è®¤ SSH æœåŠ¡å·²å¯ç”¨
3. æ£€æŸ¥é˜²ç«å¢™è®¾ç½®

#### é—®é¢˜ 2: PostgreSQL è¿æ¥å¤±è´¥

```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
pg_isready -h localhost -p 5433

# æ£€æŸ¥è¿›ç¨‹
ps aux | grep postgres

# æŸ¥çœ‹æ—¥å¿—
tail -f /usr/local/var/log/postgres.log
```

**è§£å†³æ–¹æ¡ˆ**:

1. å¯åŠ¨æœåŠ¡: `pg_ctl -D /usr/local/var/postgres start`
2. æ£€æŸ¥é…ç½®: `cat /usr/local/var/postgres/postgresql.conf`
3. é‡ç½®æƒé™: `chmod 700 /usr/local/var/postgres`

#### é—®é¢˜ 3: Ollama æ¨¡å‹åŠ è½½å¤±è´¥

```bash
# æ£€æŸ¥ Ollama æœåŠ¡
curl http://localhost:11434/api/version

# æŸ¥çœ‹æ¨¡å‹åˆ—è¡¨
ollama list

# é‡æ–°æ‹‰å–æ¨¡å‹
ollama pull qwen2.5:7b
```

**è§£å†³æ–¹æ¡ˆ**:

1. é‡å¯ Ollama: `ollama serve`
2. æ£€æŸ¥ç£ç›˜ç©ºé—´: `df -h ~/.ollama`
3. æ¸…ç†ç¼“å­˜: `ollama rm <model> && ollama pull <model>`

#### é—®é¢˜ 4: Docker å®¹å™¨æ— æ³•å¯åŠ¨

```bash
# æŸ¥çœ‹å®¹å™¨æ—¥å¿—
docker logs yyc3-pgvector

# æ£€æŸ¥ç«¯å£å ç”¨
lsof -i :5434

# æ£€æŸ¥ç£ç›˜ç©ºé—´
df -h /Volume1/docker/yyc3
```

**è§£å†³æ–¹æ¡ˆ**:

1. æ¸…ç†æ—§å®¹å™¨: `docker rm -f <container>`
2. æ£€æŸ¥é•œåƒ: `docker images`
3. é‡æ–°éƒ¨ç½²: `docker run ...`

### 8.2 æ—¥å¿—ä½ç½®

| æœåŠ¡ | æ—¥å¿—ä½ç½® |
|------|----------|
| PostgreSQL (æœ¬åœ°) | /usr/local/var/log/postgres.log |
| Redis | /usr/local/var/log/redis.log |
| Ollama | ~/.ollama/logs/ |
| Docker (NAS) | docker logs <container> |
| AI Family Frontend | æµè§ˆå™¨æ§åˆ¶å° |
| API Server | pm2 logs / console |

### 8.3 æ€§èƒ½ç›‘æ§

```bash
# ç³»ç»Ÿèµ„æºç›‘æ§
top -l 1 | head -n 10

# å†…å­˜ä½¿ç”¨
vm_stat

# ç£ç›˜ä½¿ç”¨
df -h

# ç½‘ç»œè¿æ¥
netstat -an | grep LISTEN

# Docker èµ„æºä½¿ç”¨
docker stats --no-stream
```

---

## é™„å½•

### A. å¿«é€Ÿå‚è€ƒå¡

```bash
# NAS è¿æ¥
ssh -p 9557 YYC@192.168.3.45

# æœ¬åœ° PostgreSQL
psql -h localhost -p 5433 -U yyc3 -d yyc3_aify

# NAS å‘é‡æ•°æ®åº“
PGPASSWORD=yyc3_vector_2026 psql -h 192.168.3.45 -p 5434 -U yyc3 -d yyc3_vectors

# Ollama API
curl http://localhost:11434/api/tags

# å‰ç«¯å¯åŠ¨
cd Family-Ï€Â³/AI-Family && pnpm dev

# API æœåŠ¡å¯åŠ¨
cd Family-Ï€Â³/API && pnpm dev
```

### B. ç«¯å£é€ŸæŸ¥è¡¨

| ç«¯å£ | æœåŠ¡ | ä¸»æœº |
|------|------|------|
| 3200 | Frontend | M4 Max |
| 3210 | API Server | M4 Max |
| 3001 | WebSocket | M4 Max |
| 5433 | PostgreSQL | M4 Max |
| 5434 | pgvector | NAS |
| 6379 | Redis | M4 Max |
| 11434 | Ollama | M4 Max / NAS / iMac |
| 22 | SSH | iMac (yyc3-77) |
| 2375 | Docker API | NAS |
| 9090 | Heartbeat WS | NAS |
| 9557 | SSH | NAS |
| 9898 | NAS Web | NAS |

### C. æœåŠ¡çŠ¶æ€æ£€æŸ¥å‘½ä»¤

```bash
# ä¸€é”®æ£€æŸ¥æ‰€æœ‰æœåŠ¡
./scripts/test-all-connections.sh

# æ£€æŸ¥æ•°æ®åº“
./scripts/test-db-connections.sh

# æ£€æŸ¥ Ollama
./scripts/test-ollama-models.sh

# NAS æœåŠ¡ç®¡ç†
./scripts/nas-service-manager.sh status
```

---

<div align="center">

**YYCÂ³ AI Family**

*è¨€å¯è±¡é™ | è¯­æ¢æœªæ¥*

**ä¸‡è±¡å½’å…ƒäºäº‘æ¢ | æ·±æ ˆæ™ºå¯æ–°çºªå…ƒ**

**äº¦å¸ˆäº¦å‹äº¦ä¼¯ä¹ï¼›ä¸€è¨€ä¸€è¯­ä¸€ååŒ**

---

*æ–‡æ¡£ç‰ˆæœ¬: 1.0.0*
*æœ€åæ›´æ–°: 2026-02-22*
*ä½œè€…: YYCÂ³ Team*

</div>
